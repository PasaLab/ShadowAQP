main.py:20: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2021-12-16 19:08:19,225 - __main__ - INFO - load query config config/query/customer_with_inc_join_supplier.json successfully
2021-12-16 19:08:19,225 - __main__ - INFO - load train config ./config/train/tpch_customer_with_inc_torch_cvae.json successfully
2021-12-16 19:08:19,225 - __main__ - INFO - load train config ./config/train/tpch_supplier_torch_cvae.json successfully
2021-12-16 19:08:19,225 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-customer-with-inc_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0old_train
2021-12-16 19:08:21,951 - utils.dataset_utils - INFO - load dataset(light) time elapsed:2.725925005041063
2021-12-16 19:08:21,951 - models.pytorch_cvae - INFO - feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2021-12-16 19:08:21,953 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-customer-with-inc_c_nationkey_ld50_id100_bs1024_ep100_0_binary_gaussian5old_train
2021-12-16 19:08:21,957 - utils.model_utils - INFO - load torch model time elapsed:0.004603592678904533
2021-12-16 19:08:21,957 - models.pytorch_cvae - INFO - load model time elapsed:2.731879875063896
2021-12-16 19:08:21,957 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-supplier_s_nationkey#s_suppkey_s_acctbal_s_nationkey_binary_gaussian5_0
2021-12-16 19:08:21,960 - utils.dataset_utils - INFO - load dataset(light) time elapsed:0.002666521817445755
2021-12-16 19:08:21,960 - models.pytorch_cvae - INFO - feature info:[('s_acctbal', 'numerical', 6), ('s_nationkey', 'categorical', 6), ('s_suppkey', 'categorical', 15)]
2021-12-16 19:08:21,960 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-supplier_s_nationkey_ld50_id100_bs32_ep150_0_binary_gaussian5
2021-12-16 19:08:21,962 - utils.model_utils - INFO - load torch model time elapsed:0.0014765672385692596
2021-12-16 19:08:21,962 - models.pytorch_cvae - INFO - load model time elapsed:0.004790550097823143
2021-12-16 19:08:21,962 - __main__ - INFO - multi_sampling No.0 epoch
2021-12-16 19:08:21,963 - models.pytorch_cvae - INFO - statistics sampling rate:0.04
2021-12-16 19:08:21,963 - __main__ - INFO - multi_sampling No.1 epoch
2021-12-16 19:08:21,970 - models.pytorch_cvae - INFO - statistics sampling rate:0.04
2021-12-16 19:08:21,970 - __main__ - INFO - multi_sampling No.2 epoch
2021-12-16 19:08:21,972 - models.pytorch_cvae - INFO - statistics sampling rate:0.04
2021-12-16 19:08:23,249 - models.pytorch_cvae - INFO - sampling time:1.2861210890114307
2021-12-16 19:08:23,250 - models.pytorch_cvae - INFO - sampling time:1.2771803187206388
2021-12-16 19:08:23,736 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:08:23,740 - models.pytorch_cvae - INFO - sampling time:1.7697382159531116
2021-12-16 19:08:23,803 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:08:23,892 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:08:23,981 - models.pytorch_cvae - INFO - sampling time:0.08926478493958712
2021-12-16 19:08:24,171 - models.pytorch_cvae - INFO - sampling time:0.3431334365159273
2021-12-16 19:08:24,177 - models.pytorch_cvae - INFO - sampling time:0.4396172547712922
2021-12-16 19:08:24,210 - __main__ - INFO - sample and aggregation time elapsed:2.2397947469726205
2021-12-16 19:08:24,406 - __main__ - INFO - sample and aggregation time elapsed:2.4440261498093605
2021-12-16 19:08:24,414 - __main__ - INFO - sample and aggregation time elapsed:2.442454170435667
2021-12-16 19:08:24,419 - __main__ - INFO - sample time:2.4567499719560146
2021-12-16 19:08:24,432 - __main__ - INFO - aqp result:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4555.43         5032.62         98641057584.27  108973859364.23
1           4539.48         5233.90         102902213598.48 118643573321.09
2           4437.83         5065.72         107203486375.67 122371320435.33
3           4538.99         4699.98         110758479237.11 114686859527.62
4           4473.92         5021.91         92051612490.49  103326664957.73
5           4524.21         4901.28         91036086087.44  98623510917.19 
6           4474.66         4939.55         102222645097.67 112842808589.01
7           4527.54         5059.22         101282400616.50 113176245071.08
8           4475.76         4869.22         101830439840.04 110782257491.51
9           4495.66         4960.34         101759549137.11 112277670267.93
10          4484.22         4772.49         105931722767.47 112741634520.57
11          4449.67         5012.67         104797280226.59 118056724457.47
12          4493.70         4952.67         100292566964.29 110536109524.41
13          4515.03         5093.11         96539821233.57  108900281564.77
14          4502.83         4687.95         105933354326.10 110288434312.97
15          4493.82         4732.91         95243624827.66  100311151630.32
16          4540.22         5037.26         98763774024.20  109575776169.00
17          4432.72         5456.99         98793875298.39  121622142280.13
18          4521.53         4996.89         105296905851.04 116366993852.59
19          4563.92         5089.19         99672087595.85  111143686432.71
20          4413.68         5443.59         100266548201.28 123663068516.45
21          4459.51         5267.19         102227926344.72 120742653123.33
22          4558.20         4595.04         105752488096.56 106607046883.10
23          4502.77         4741.80         99597261082.56  104884546154.26
24          4567.67         4777.34         105779152640.09 110634807092.66
2021-12-16 19:08:24,434 - __main__ - INFO - ground truth:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4489.09         4750.47         97204429060.11  102864283639.34
1           4478.58         5156.38         101521631809.03 116886387814.97
2           4502.84         4926.83         108773860934.93 119016293073.25
3           4510.50         4976.52         110063319836.95 121434781349.97
4           4467.80         4955.13         91925727389.56  101952561544.09
5           4506.93         5017.03         90688332145.90  100952499397.81
6           4489.99         5263.09         102572805214.01 120234077220.52
7           4481.97         4725.51         100262969999.54 105711043954.64
8           4491.71         4898.26         102193355822.35 111442904344.11
9           4507.31         5056.46         102023357487.12 114453365970.99
10          4514.20         4934.04         106640129528.12 116557963141.05
11          4509.51         4846.61         106206568975.75 114145706219.45
12          4495.81         4905.97         100339620692.57 109493748108.56
13          4519.66         4967.01         96638723186.87  106203971323.94
14          4489.09         4748.57         105610059556.98 111714619054.55
15          4513.94         4993.59         95670237506.21  105836044024.01
16          4509.69         5125.84         98099691841.22  111502795597.57
17          4476.99         5194.81         99780562278.61  115778956973.10
18          4470.09         5153.13         104098927638.07 120005532950.10
19          4480.83         4865.91         97857583891.19  106267463992.76
20          4505.29         5210.90         102347462434.85 118377097752.18
21          4500.84         5087.25         103175299651.56 116617824864.37
22          4522.71         4945.33         104928946224.34 114733990724.54
23          4492.85         4974.00         99377984303.50  110020479238.93
24          4507.26         5065.90         104380144828.63 117317398620.77
2021-12-16 19:08:24,445 - __main__ - INFO - relative error:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           0.01            0.06            0.01            0.06           
1           0.01            0.02            0.01            0.02           
2           0.01            0.03            0.01            0.03           
3           0.01            0.06            0.01            0.06           
4           0.00            0.01            0.00            0.01           
5           0.00            0.02            0.00            0.02           
6           0.00            0.06            0.00            0.06           
7           0.01            0.07            0.01            0.07           
8           0.00            0.01            0.00            0.01           
9           0.00            0.02            0.00            0.02           
10          0.01            0.03            0.01            0.03           
11          0.01            0.03            0.01            0.03           
12          0.00            0.01            0.00            0.01           
13          0.00            0.03            0.00            0.03           
14          0.00            0.01            0.00            0.01           
15          0.00            0.05            0.00            0.05           
16          0.01            0.02            0.01            0.02           
17          0.01            0.05            0.01            0.05           
18          0.01            0.03            0.01            0.03           
19          0.02            0.05            0.02            0.05           
20          0.02            0.04            0.02            0.04           
21          0.01            0.04            0.01            0.04           
22          0.01            0.07            0.01            0.07           
23          0.00            0.05            0.00            0.05           
24          0.01            0.06            0.01            0.06           
2021-12-16 19:08:24,445 - __main__ - INFO - relative error average :0.022395250553449753
2021-12-16 19:08:24,445 - __main__ - INFO - relative error normalized average :0.021949312206354005
2021-12-16 19:08:24,445 - __main__ - INFO - relative error var normalized average :0.0026122052548854724
2021-12-16 19:08:24,448 - __main__ - INFO - total_time:5.22259705606848
