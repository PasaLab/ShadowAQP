main.py:20: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2021-12-16 19:07:31,694 - __main__ - INFO - load query config config/query/customer_with_inc_join_supplier.json successfully
2021-12-16 19:07:31,694 - __main__ - INFO - load train config ./config/train/tpch_customer_with_inc_torch_cvae.json successfully
2021-12-16 19:07:31,694 - __main__ - INFO - load train config ./config/train/tpch_supplier_torch_cvae.json successfully
2021-12-16 19:07:31,694 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-customer-with-inc_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0old_train
2021-12-16 19:07:34,544 - utils.dataset_utils - INFO - load dataset(light) time elapsed:2.849845763295889
2021-12-16 19:07:34,544 - models.pytorch_cvae - INFO - feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2021-12-16 19:07:34,545 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-customer-with-inc_c_nationkey_ld50_id100_bs1024_ep100_0_binary_gaussian5old_train
2021-12-16 19:07:34,550 - utils.model_utils - INFO - load torch model time elapsed:0.0050215162336826324
2021-12-16 19:07:34,550 - models.pytorch_cvae - INFO - load model time elapsed:2.8562103686854243
2021-12-16 19:07:34,550 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-supplier_s_nationkey#s_suppkey_s_acctbal_s_nationkey_binary_gaussian5_0
2021-12-16 19:07:34,553 - utils.dataset_utils - INFO - load dataset(light) time elapsed:0.002763175405561924
2021-12-16 19:07:34,553 - models.pytorch_cvae - INFO - feature info:[('s_acctbal', 'numerical', 6), ('s_nationkey', 'categorical', 6), ('s_suppkey', 'categorical', 15)]
2021-12-16 19:07:34,554 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-supplier_s_nationkey_ld50_id100_bs32_ep150_0_binary_gaussian5
2021-12-16 19:07:34,555 - utils.model_utils - INFO - load torch model time elapsed:0.00139701459556818
2021-12-16 19:07:34,555 - models.pytorch_cvae - INFO - load model time elapsed:0.004821258597075939
2021-12-16 19:07:34,555 - __main__ - INFO - multi_sampling No.0 epoch
2021-12-16 19:07:34,556 - models.pytorch_cvae - INFO - statistics sampling rate:0.02
2021-12-16 19:07:34,556 - __main__ - INFO - multi_sampling No.1 epoch
2021-12-16 19:07:34,562 - models.pytorch_cvae - INFO - statistics sampling rate:0.02
2021-12-16 19:07:34,563 - __main__ - INFO - multi_sampling No.2 epoch
2021-12-16 19:07:34,564 - models.pytorch_cvae - INFO - statistics sampling rate:0.02
2021-12-16 19:07:35,493 - models.pytorch_cvae - INFO - sampling time:0.9306775229051709
2021-12-16 19:07:35,494 - models.pytorch_cvae - INFO - sampling time:0.9380153613165021
2021-12-16 19:07:35,751 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:07:35,768 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:07:35,772 - models.pytorch_cvae - INFO - sampling time:1.2079133093357086
2021-12-16 19:07:35,843 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:07:35,937 - models.pytorch_cvae - INFO - sampling time:0.09422636777162552
2021-12-16 19:07:36,031 - models.pytorch_cvae - INFO - sampling time:0.2786809876561165
2021-12-16 19:07:36,044 - __main__ - INFO - sample and aggregation time elapsed:1.4800392650067806
2021-12-16 19:07:36,120 - models.pytorch_cvae - INFO - sampling time:0.35094119515269995
2021-12-16 19:07:36,159 - __main__ - INFO - sample and aggregation time elapsed:1.59649992082268
2021-12-16 19:07:36,218 - __main__ - INFO - sample and aggregation time elapsed:1.6628391351550817
2021-12-16 19:07:36,220 - __main__ - INFO - sample time:1.6651430241763592
2021-12-16 19:07:36,228 - __main__ - INFO - aqp result:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4485.16         4914.20         97119343845.23  106409711629.26
1           4440.46         5223.35         100657558351.44 118404403190.89
2           4545.43         4791.08         109802751369.22 115736957577.77
3           4527.17         4763.48         110470069447.05 116236354154.33
4           4387.04         5049.35         90264021524.66  103891139779.00
5           4525.57         5618.80         91063523414.47  113061481917.04
6           4478.77         5047.63         102316564580.14 115311848946.45
7           4536.55         4878.48         101483926866.78 109132921912.90
8           4570.57         4922.15         103987358187.80 111986447427.35
9           4553.55         5156.91         103069870966.84 116727010656.93
10          4559.17         4818.07         107702409419.28 113818521340.88
11          4546.50         4967.12         107077556453.81 116984034554.23
12          4663.20         4885.62         104075497713.71 109039483014.79
13          4423.61         4789.68         94585096264.95  102412339152.49
14          4547.50         4687.61         106984225415.98 110280512198.59
15          4473.35         4914.11         94809928348.78  104151584186.63
16          4467.38         5237.97         97179210694.07  113942001454.81
17          4578.59         5150.57         102044946599.80 114792945551.73
18          4563.95         4866.72         106284868917.58 113335559973.26
19          4560.32         5180.92         99593560564.48  113146906228.42
20          4454.20         4974.74         101186857997.72 113012079893.69
21          4499.74         5097.12         103150140250.58 116844112864.36
22          4562.30         4853.87         105847578682.48 112612027946.00
23          4466.33         4864.14         98791435027.92  107590535013.20
24          4453.75         4931.05         103140958467.49 114194423538.52
2021-12-16 19:07:36,230 - __main__ - INFO - ground truth:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4489.09         4750.47         97204429060.11  102864283639.34
1           4478.58         5156.38         101521631809.03 116886387814.97
2           4502.84         4926.83         108773860934.93 119016293073.25
3           4510.50         4976.52         110063319836.95 121434781349.97
4           4467.80         4955.13         91925727389.56  101952561544.09
5           4506.93         5017.03         90688332145.90  100952499397.81
6           4489.99         5263.09         102572805214.01 120234077220.52
7           4481.97         4725.51         100262969999.54 105711043954.64
8           4491.71         4898.26         102193355822.35 111442904344.11
9           4507.31         5056.46         102023357487.12 114453365970.99
10          4514.20         4934.04         106640129528.12 116557963141.05
11          4509.51         4846.61         106206568975.75 114145706219.45
12          4495.81         4905.97         100339620692.57 109493748108.56
13          4519.66         4967.01         96638723186.87  106203971323.94
14          4489.09         4748.57         105610059556.98 111714619054.55
15          4513.94         4993.59         95670237506.21  105836044024.01
16          4509.69         5125.84         98099691841.22  111502795597.57
17          4476.99         5194.81         99780562278.61  115778956973.10
18          4470.09         5153.13         104098927638.07 120005532950.10
19          4480.83         4865.91         97857583891.19  106267463992.76
20          4505.29         5210.90         102347462434.85 118377097752.18
21          4500.84         5087.25         103175299651.56 116617824864.37
22          4522.71         4945.33         104928946224.34 114733990724.54
23          4492.85         4974.00         99377984303.50  110020479238.93
24          4507.26         5065.90         104380144828.63 117317398620.77
2021-12-16 19:07:36,239 - __main__ - INFO - relative error:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           0.00            0.03            0.00            0.03           
1           0.01            0.01            0.01            0.01           
2           0.01            0.03            0.01            0.03           
3           0.00            0.04            0.00            0.04           
4           0.02            0.02            0.02            0.02           
5           0.00            0.12            0.00            0.12           
6           0.00            0.04            0.00            0.04           
7           0.01            0.03            0.01            0.03           
8           0.02            0.00            0.02            0.00           
9           0.01            0.02            0.01            0.02           
10          0.01            0.02            0.01            0.02           
11          0.01            0.02            0.01            0.02           
12          0.04            0.00            0.04            0.00           
13          0.02            0.04            0.02            0.04           
14          0.01            0.01            0.01            0.01           
15          0.01            0.02            0.01            0.02           
16          0.01            0.02            0.01            0.02           
17          0.02            0.01            0.02            0.01           
18          0.02            0.06            0.02            0.06           
19          0.02            0.06            0.02            0.06           
20          0.01            0.05            0.01            0.05           
21          0.00            0.00            0.00            0.00           
22          0.01            0.02            0.01            0.02           
23          0.01            0.02            0.01            0.02           
24          0.01            0.03            0.01            0.03           
2021-12-16 19:07:36,239 - __main__ - INFO - relative error average :0.02063587639367924
2021-12-16 19:07:36,239 - __main__ - INFO - relative error normalized average :0.020232574786474347
2021-12-16 19:07:36,239 - __main__ - INFO - relative error var normalized average :0.0023057941731865895
2021-12-16 19:07:36,240 - __main__ - INFO - total_time:4.5463353600353
