main.py:20: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2021-12-16 19:04:37,846 - __main__ - INFO - load query config config/query/customer_with_inc_join_supplier.json successfully
2021-12-16 19:04:37,846 - __main__ - INFO - load train config ./config/train/tpch_customer_with_inc_torch_cvae.json successfully
2021-12-16 19:04:37,846 - __main__ - INFO - load train config ./config/train/tpch_supplier_torch_cvae.json successfully
2021-12-16 19:04:37,847 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-customer-with-inc_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0sample_train
2021-12-16 19:04:40,572 - utils.dataset_utils - INFO - load dataset(light) time elapsed:2.725605983287096
2021-12-16 19:04:40,572 - models.pytorch_cvae - INFO - feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2021-12-16 19:04:40,573 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-customer-with-inc_c_nationkey_ld50_id100_bs1024_ep100_0_binary_gaussian5sample_train
2021-12-16 19:04:40,575 - utils.model_utils - INFO - load torch model time elapsed:0.0019539957866072655
2021-12-16 19:04:40,575 - models.pytorch_cvae - INFO - load model time elapsed:2.7288974495604634
2021-12-16 19:04:40,575 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-supplier_s_nationkey#s_suppkey_s_acctbal_s_nationkey_binary_gaussian5_0
2021-12-16 19:04:40,578 - utils.dataset_utils - INFO - load dataset(light) time elapsed:0.002638121135532856
2021-12-16 19:04:40,578 - models.pytorch_cvae - INFO - feature info:[('s_acctbal', 'numerical', 6), ('s_nationkey', 'categorical', 6), ('s_suppkey', 'categorical', 15)]
2021-12-16 19:04:40,579 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-supplier_s_nationkey_ld50_id100_bs32_ep150_0_binary_gaussian5
2021-12-16 19:04:40,583 - utils.model_utils - INFO - load torch model time elapsed:0.0042671924456954
2021-12-16 19:04:40,583 - models.pytorch_cvae - INFO - load model time elapsed:0.007562896236777306
2021-12-16 19:04:40,583 - __main__ - INFO - multi_sampling No.0 epoch
2021-12-16 19:04:40,583 - models.pytorch_cvae - INFO - statistics sampling rate:0.06
2021-12-16 19:04:40,584 - __main__ - INFO - multi_sampling No.1 epoch
2021-12-16 19:04:40,589 - models.pytorch_cvae - INFO - statistics sampling rate:0.06
2021-12-16 19:04:40,590 - __main__ - INFO - multi_sampling No.2 epoch
2021-12-16 19:04:40,591 - models.pytorch_cvae - INFO - statistics sampling rate:0.06
2021-12-16 19:04:42,037 - models.pytorch_cvae - INFO - sampling time:1.4466471085324883
2021-12-16 19:04:42,042 - models.pytorch_cvae - INFO - sampling time:1.4506756262853742
2021-12-16 19:04:42,072 - models.pytorch_cvae - INFO - sampling time:1.4886070899665356
2021-12-16 19:04:43,021 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:04:43,062 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:04:43,071 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:04:43,237 - models.pytorch_cvae - INFO - sampling time:0.16573216672986746
2021-12-16 19:04:43,305 - models.pytorch_cvae - INFO - sampling time:0.24277666863054037
2021-12-16 19:04:43,363 - models.pytorch_cvae - INFO - sampling time:0.339461924508214
2021-12-16 19:04:43,613 - __main__ - INFO - sample and aggregation time elapsed:3.0293921902775764
2021-12-16 19:04:43,688 - __main__ - INFO - sample and aggregation time elapsed:3.096405589953065
2021-12-16 19:04:43,704 - __main__ - INFO - sample and aggregation time elapsed:3.1149481274187565
2021-12-16 19:04:43,709 - __main__ - INFO - sample time:3.1255154320970178
2021-12-16 19:04:43,723 - __main__ - INFO - aqp result:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4319.55         5454.81         93533294890.79  118115764588.87
1           4416.01         5098.37         100103260578.15 115571328739.95
2           4361.03         4918.11         105348418105.71 118805603952.63
3           4378.84         4863.19         106850664568.20 118669400220.53
4           4421.92         5267.96         90981784216.16  108389171400.06
5           4399.56         4828.96         88527961163.81  97168283931.21 
6           4380.32         5000.78         100067389933.52 114241577688.54
7           4327.27         4828.42         96802147670.79  108012985703.15
8           4348.32         5114.62         98930890951.85  116365466910.06
9           4309.20         4716.46         97539003134.82  106757393603.35
10          4342.91         5002.58         102593591564.26 118177063519.61
11          4387.10         4929.15         103323537193.30 116089616405.03
12          4369.28         4650.53         97515713598.67  103792722524.61
13          4403.47         5642.78         94154423453.65  120653151620.21
14          4380.47         4569.22         103054674573.94 107495361305.57
15          4426.10         5013.04         93808384573.64  106248286060.76
16          4351.94         5137.47         94668079616.00  111755783418.19
17          4349.56         5711.90         96940341667.05  127303355234.65
18          4390.81         5012.30         102252623386.60 116725832629.79
19          4413.39         4960.00         96384758845.18  108322331911.94
20          4386.92         5058.43         99658455584.22  114913427701.40
21          4416.21         5327.41         101235211388.83 122123169480.68
22          4411.07         4951.96         102338902503.53 114887922189.76
23          4386.31         4914.78         97021457218.93  108710600656.34
24          4340.46         4840.83         100517440728.48 112105136452.42
2021-12-16 19:04:43,726 - __main__ - INFO - ground truth:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4489.09         4750.47         97204429060.11  102864283639.34
1           4478.58         5156.38         101521631809.03 116886387814.97
2           4502.84         4926.83         108773860934.93 119016293073.25
3           4510.50         4976.52         110063319836.95 121434781349.97
4           4467.80         4955.13         91925727389.56  101952561544.09
5           4506.93         5017.03         90688332145.90  100952499397.81
6           4489.99         5263.09         102572805214.01 120234077220.52
7           4481.97         4725.51         100262969999.54 105711043954.64
8           4491.71         4898.26         102193355822.35 111442904344.11
9           4507.31         5056.46         102023357487.12 114453365970.99
10          4514.20         4934.04         106640129528.12 116557963141.05
11          4509.51         4846.61         106206568975.75 114145706219.45
12          4495.81         4905.97         100339620692.57 109493748108.56
13          4519.66         4967.01         96638723186.87  106203971323.94
14          4489.09         4748.57         105610059556.98 111714619054.55
15          4513.94         4993.59         95670237506.21  105836044024.01
16          4509.69         5125.84         98099691841.22  111502795597.57
17          4476.99         5194.81         99780562278.61  115778956973.10
18          4470.09         5153.13         104098927638.07 120005532950.10
19          4480.83         4865.91         97857583891.19  106267463992.76
20          4505.29         5210.90         102347462434.85 118377097752.18
21          4500.84         5087.25         103175299651.56 116617824864.37
22          4522.71         4945.33         104928946224.34 114733990724.54
23          4492.85         4974.00         99377984303.50  110020479238.93
24          4507.26         5065.90         104380144828.63 117317398620.77
2021-12-16 19:04:43,737 - __main__ - INFO - relative error:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           0.04            0.15            0.04            0.15           
1           0.01            0.01            0.01            0.01           
2           0.03            0.00            0.03            0.00           
3           0.03            0.02            0.03            0.02           
4           0.01            0.06            0.01            0.06           
5           0.02            0.04            0.02            0.04           
6           0.02            0.05            0.02            0.05           
7           0.03            0.02            0.03            0.02           
8           0.03            0.04            0.03            0.04           
9           0.04            0.07            0.04            0.07           
10          0.04            0.01            0.04            0.01           
11          0.03            0.02            0.03            0.02           
12          0.03            0.05            0.03            0.05           
13          0.03            0.14            0.03            0.14           
14          0.02            0.04            0.02            0.04           
15          0.02            0.00            0.02            0.00           
16          0.03            0.00            0.03            0.00           
17          0.03            0.10            0.03            0.10           
18          0.02            0.03            0.02            0.03           
19          0.02            0.02            0.02            0.02           
20          0.03            0.03            0.03            0.03           
21          0.02            0.05            0.02            0.05           
22          0.02            0.00            0.02            0.00           
23          0.02            0.01            0.02            0.01           
24          0.04            0.04            0.04            0.04           
2021-12-16 19:04:43,737 - __main__ - INFO - relative error average :0.03363341980856365
2021-12-16 19:04:43,737 - __main__ - INFO - relative error normalized average :0.032696838476264645
2021-12-16 19:04:43,737 - __main__ - INFO - relative error var normalized average :0.005215804382495328
2021-12-16 19:04:43,740 - __main__ - INFO - total_time:5.894040396437049
