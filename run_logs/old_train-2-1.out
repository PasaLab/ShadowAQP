main.py:20: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2021-12-16 19:07:16,954 - __main__ - INFO - load query config config/query/customer_with_inc_join_supplier.json successfully
2021-12-16 19:07:16,954 - __main__ - INFO - load train config ./config/train/tpch_customer_with_inc_torch_cvae.json successfully
2021-12-16 19:07:16,954 - __main__ - INFO - load train config ./config/train/tpch_supplier_torch_cvae.json successfully
2021-12-16 19:07:16,955 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-customer-with-inc_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0old_train
2021-12-16 19:07:19,689 - utils.dataset_utils - INFO - load dataset(light) time elapsed:2.7348850555717945
2021-12-16 19:07:19,690 - models.pytorch_cvae - INFO - feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2021-12-16 19:07:19,691 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-customer-with-inc_c_nationkey_ld50_id100_bs1024_ep100_0_binary_gaussian5old_train
2021-12-16 19:07:19,693 - utils.model_utils - INFO - load torch model time elapsed:0.0019592409953475
2021-12-16 19:07:19,693 - models.pytorch_cvae - INFO - load model time elapsed:2.7381960367783904
2021-12-16 19:07:19,693 - utils.dataset_utils - INFO - load existing dataset(light):tpch-1m-supplier_s_nationkey#s_suppkey_s_acctbal_s_nationkey_binary_gaussian5_0
2021-12-16 19:07:19,695 - utils.dataset_utils - INFO - load dataset(light) time elapsed:0.002598281018435955
2021-12-16 19:07:19,695 - models.pytorch_cvae - INFO - feature info:[('s_acctbal', 'numerical', 6), ('s_nationkey', 'categorical', 6), ('s_suppkey', 'categorical', 15)]
2021-12-16 19:07:19,696 - utils.model_utils - INFO - load model name:torch_cvae_tpch-1m-supplier_s_nationkey_ld50_id100_bs32_ep150_0_binary_gaussian5
2021-12-16 19:07:19,700 - utils.model_utils - INFO - load torch model time elapsed:0.0041417321190238
2021-12-16 19:07:19,700 - models.pytorch_cvae - INFO - load model time elapsed:0.0074159689247608185
2021-12-16 19:07:19,700 - __main__ - INFO - multi_sampling No.0 epoch
2021-12-16 19:07:19,701 - models.pytorch_cvae - INFO - statistics sampling rate:0.02
2021-12-16 19:07:19,701 - __main__ - INFO - multi_sampling No.1 epoch
2021-12-16 19:07:19,707 - models.pytorch_cvae - INFO - statistics sampling rate:0.02
2021-12-16 19:07:19,707 - __main__ - INFO - multi_sampling No.2 epoch
2021-12-16 19:07:19,709 - models.pytorch_cvae - INFO - statistics sampling rate:0.02
2021-12-16 19:07:20,449 - models.pytorch_cvae - INFO - sampling time:0.748454506509006
2021-12-16 19:07:20,755 - models.pytorch_cvae - INFO - sampling time:1.0474814400076866
2021-12-16 19:07:20,759 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:07:20,814 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:07:20,818 - models.pytorch_cvae - INFO - sampling time:1.1081690127030015
2021-12-16 19:07:20,892 - models.pytorch_cvae - INFO - statistics sampling rate:0.1
2021-12-16 19:07:20,968 - models.pytorch_cvae - INFO - sampling time:0.19578549824655056
2021-12-16 19:07:21,050 - models.pytorch_cvae - INFO - sampling time:0.15786948800086975
2021-12-16 19:07:21,091 - __main__ - INFO - sample and aggregation time elapsed:1.3905669804662466
2021-12-16 19:07:21,096 - models.pytorch_cvae - INFO - sampling time:0.2823918219655752
2021-12-16 19:07:21,176 - __main__ - INFO - sample and aggregation time elapsed:1.466665874235332
2021-12-16 19:07:21,214 - __main__ - INFO - sample and aggregation time elapsed:1.5066543724387884
2021-12-16 19:07:21,218 - __main__ - INFO - sample time:1.5182235734537244
2021-12-16 19:07:21,232 - __main__ - INFO - aqp result:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4495.67         4580.55         97347016792.60  99184925315.57 
1           4552.05         5257.46         103187105888.35 119177688852.69
2           4628.64         5143.54         111813009971.19 124251201219.68
3           4465.99         5176.03         108977272239.59 126303259593.92
4           4497.80         4503.82         92542974196.13  92666736922.71 
5           4450.10         5107.77         89544805986.02  102778481032.47
6           4507.60         5271.71         102975074825.18 120431037042.11
7           4537.96         4876.64         101515449831.09 109091706557.54
8           4412.14         4749.34         100382977935.68 108054836057.99
9           4489.75         5049.59         101625766215.10 114297832025.41
10          4542.56         4990.56         107309913756.83 117893152254.73
11          4535.90         4530.62         106828027644.10 106703619657.11
12          4428.52         4421.70         98837776156.28  98685487300.44 
13          4507.43         4775.32         96377302082.85  102105244881.59
14          4547.97         4866.98         106995215696.07 114500443109.40
15          4412.16         5433.63         93513012846.55  115162339480.91
16          4587.93         5164.81         99801637459.06  112350465286.70
17          4517.54         4829.48         100684210616.34 107636675285.88
18          4390.60         5250.03         102247765841.10 122262157171.50
19          4388.85         4959.90         95848844504.31  108319967674.59
20          4516.38         4972.49         102599397032.15 112960985217.46
21          4461.68         5547.56         102277626654.35 127169919456.88
22          4581.95         4542.24         106303470520.39 105382090063.03
23          4499.55         4920.61         99526105260.04  108839716341.77
24          4540.86         4984.24         105158289062.08 115426233346.19
2021-12-16 19:07:21,235 - __main__ - INFO - ground truth:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           4489.09         4750.47         97204429060.11  102864283639.34
1           4478.58         5156.38         101521631809.03 116886387814.97
2           4502.84         4926.83         108773860934.93 119016293073.25
3           4510.50         4976.52         110063319836.95 121434781349.97
4           4467.80         4955.13         91925727389.56  101952561544.09
5           4506.93         5017.03         90688332145.90  100952499397.81
6           4489.99         5263.09         102572805214.01 120234077220.52
7           4481.97         4725.51         100262969999.54 105711043954.64
8           4491.71         4898.26         102193355822.35 111442904344.11
9           4507.31         5056.46         102023357487.12 114453365970.99
10          4514.20         4934.04         106640129528.12 116557963141.05
11          4509.51         4846.61         106206568975.75 114145706219.45
12          4495.81         4905.97         100339620692.57 109493748108.56
13          4519.66         4967.01         96638723186.87  106203971323.94
14          4489.09         4748.57         105610059556.98 111714619054.55
15          4513.94         4993.59         95670237506.21  105836044024.01
16          4509.69         5125.84         98099691841.22  111502795597.57
17          4476.99         5194.81         99780562278.61  115778956973.10
18          4470.09         5153.13         104098927638.07 120005532950.10
19          4480.83         4865.91         97857583891.19  106267463992.76
20          4505.29         5210.90         102347462434.85 118377097752.18
21          4500.84         5087.25         103175299651.56 116617824864.37
22          4522.71         4945.33         104928946224.34 114733990724.54
23          4492.85         4974.00         99377984303.50  110020479238.93
24          4507.26         5065.90         104380144828.63 117317398620.77
2021-12-16 19:07:21,245 - __main__ - INFO - relative error:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           0.00            0.04            0.00            0.04           
1           0.02            0.02            0.02            0.02           
2           0.03            0.04            0.03            0.04           
3           0.01            0.04            0.01            0.04           
4           0.01            0.09            0.01            0.09           
5           0.01            0.02            0.01            0.02           
6           0.00            0.00            0.00            0.00           
7           0.01            0.03            0.01            0.03           
8           0.02            0.03            0.02            0.03           
9           0.00            0.00            0.00            0.00           
10          0.01            0.01            0.01            0.01           
11          0.01            0.07            0.01            0.07           
12          0.01            0.10            0.01            0.10           
13          0.00            0.04            0.00            0.04           
14          0.01            0.02            0.01            0.02           
15          0.02            0.09            0.02            0.09           
16          0.02            0.01            0.02            0.01           
17          0.01            0.07            0.01            0.07           
18          0.02            0.02            0.02            0.02           
19          0.02            0.02            0.02            0.02           
20          0.00            0.05            0.00            0.05           
21          0.01            0.09            0.01            0.09           
22          0.01            0.08            0.01            0.08           
23          0.00            0.01            0.00            0.01           
24          0.01            0.02            0.01            0.02           
2021-12-16 19:07:21,246 - __main__ - INFO - relative error average :0.02556153351860938
2021-12-16 19:07:21,246 - __main__ - INFO - relative error normalized average :0.024906533009618436
2021-12-16 19:07:21,246 - __main__ - INFO - relative error var normalized average :0.003912285791144308
2021-12-16 19:07:21,248 - __main__ - INFO - total_time:4.29384985473007
