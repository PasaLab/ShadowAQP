main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-21 00:53:07,329 - main.py[line:438] - INFO: load query config config/query/customer_join_supplier.json successfully
2022-06-21 00:53:07,329 - main.py[line:445] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-06-21 00:53:07,329 - main.py[line:445] - INFO: load train config ./config/train/tpch_supplier_torch_cvae.json successfully
2022-06-21 00:53:07,329 - dataset_utils.py[line:562] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-06-21 00:53:08,986 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:1.657239604741335
2022-06-21 00:53:08,986 - pytorch_cvae.py[line:273] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-06-21 00:53:08,989 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-06-21 00:53:11,044 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0550794526934624
2022-06-21 00:53:11,044 - pytorch_cvae.py[line:283] - INFO: load model time elapsed:3.715275801718235
2022-06-21 00:53:11,044 - dataset_utils.py[line:562] - INFO: load existing dataset(light):tpch-1m-supplier_s_nationkey_s_acctbal_s_nationkey_binary_gaussian5_0
2022-06-21 00:53:11,174 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:0.12954170629382133
2022-06-21 00:53:11,174 - pytorch_cvae.py[line:273] - INFO: feature info:[('s_acctbal', 'numerical', 6), ('s_nationkey', 'categorical', 6)]
2022-06-21 00:53:11,176 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-supplier_s_nationkey_ld100_id150_bs128_ep100_0_binary_gaussian5
2022-06-21 00:53:11,180 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.004072979092597961
2022-06-21 00:53:11,180 - pytorch_cvae.py[line:283] - INFO: load model time elapsed:0.1354636549949646
2022-06-21 00:53:11,180 - main.py[line:382] - INFO: multi_sampling No.0 epoch
2022-06-21 00:53:11,183 - main.py[line:382] - INFO: multi_sampling No.1 epoch
2022-06-21 00:53:11,185 - main.py[line:382] - INFO: multi_sampling No.2 epoch
2022-06-21 00:53:11,938 - pytorch_cvae.py[line:395] - INFO: sampling time:0.7515822686254978
2022-06-21 00:53:11,970 - pytorch_cvae.py[line:395] - INFO: sampling time:0.7853091098368168
2022-06-21 00:53:12,182 - pytorch_cvae.py[line:395] - INFO: sampling time:1.0010646022856236
2022-06-21 00:53:12,831 - pytorch_cvae.py[line:395] - INFO: sampling time:0.4646977297961712
2022-06-21 00:53:12,901 - pytorch_cvae.py[line:395] - INFO: sampling time:0.44099051505327225
2022-06-21 00:53:13,289 - pytorch_cvae.py[line:395] - INFO: sampling time:0.7835310846567154
2022-06-21 00:53:21,791 - main.py[line:366] - INFO: sample and aggregation time elapsed:10.604266546666622
2022-06-21 00:53:21,983 - main.py[line:366] - INFO: sample and aggregation time elapsed:10.798630379140377
2022-06-21 00:53:22,160 - main.py[line:366] - INFO: sample and aggregation time elapsed:10.98022137209773
2022-06-21 00:53:22,165 - main.py[line:399] - INFO: sample time:10.985313355922699
2022-06-21 00:53:22,188 - main.py[line:99] - INFO: aqp result:
             avg(c_acctbal)  avg(s_acctbal)    sum(c_acctbal)  \
c_nationkey                                                     
0           4514.85         4477.61         13183489334966.77   
1           4614.80         4602.44         13533595164383.06   
2           4552.42         4414.72         13462037461413.64   
3           4566.28         4511.83         13411657280202.37   
4           4536.40         4503.08         13360420888476.55   
5           4452.48         4585.65         13071825388106.91   
6           4481.16         4478.53         13144977905866.30   
7           4456.48         4486.16         13182782675802.59   
8           4485.75         4391.03         13255604284670.59   
9           4481.76         4571.64         13068728587067.95   
10          4434.76         4411.89         13238950008097.19   
11          4498.23         4388.27         13223037956167.76   
12          4372.57         4535.34         12864814835109.48   
13          4461.85         4573.62         13017125064370.72   
14          4495.22         4542.38         13147791414274.93   
15          4513.65         4552.82         13217722878885.70   
16          4575.43         4524.46         13273256271639.76   
17          4508.64         4477.76         13241804039737.70   
18          4542.99         4420.38         13483886362290.89   
19          4654.46         4499.68         13695119222445.51   
20          4570.41         4517.22         13349260915146.90   
21          4525.38         4564.04         13384444091300.09   
22          4436.55         4610.73         12942513491403.44   
23          4480.04         4554.26         13356941070423.43   
24          4563.63         4483.30         13446483211950.73   

               sum(s_acctbal)  
c_nationkey                    
0           13074722427670.41  
1           13497343981991.15  
2           13054830913926.58  
3           13251719164865.87  
4           13262295513207.33  
5           13462778004529.67  
6           13137257026489.26  
7           13270579385301.68  
8           12975689719211.57  
9           13330829145216.35  
10          13170678183258.56  
11          12899780848337.39  
12          13343702859354.44  
13          13343208751938.94  
14          13285734024768.91  
15          13332431361272.04  
16          13125376859688.20  
17          13151098843996.97  
18          13119969477722.82  
19          13239696428621.16  
20          13193896184828.25  
21          13498779439377.04  
22          13450654615678.97  
23          13578221476956.64  
24          13209782593338.95  
2022-06-21 00:53:22,193 - main.py[line:100] - INFO: ground truth:
             avg(c_acctbal)  avg(s_acctbal)    sum(c_acctbal)  \
c_nationkey                                                     
0           4498.95         4498.57         13137050865863.60   
1           4483.88         4470.22         13149646281809.01   
2           4511.85         4489.62         13342053689772.46   
3           4490.01         4514.69         13187641806805.82   
4           4499.30         4471.14         13251165475120.12   
5           4493.96         4520.17         13193606487126.12   
6           4496.91         4519.01         13191170068459.00   
7           4496.45         4502.13         13301026611714.75   
8           4508.75         4477.53         13323561611490.36   
9           4495.16         4476.37         13107800565918.19   
10          4508.78         4537.02         13459919946282.55   
11          4505.86         4497.51         13245445724094.84   
12          4486.76         4487.42         13200769753116.53   
13          4498.32         4477.46         13123545091893.35   
14          4492.92         4423.95         13141073384635.39   
15          4496.65         4507.04         13167934218259.21   
16          4497.97         4484.46         13048533690939.52   
17          4498.89         4469.89         13213157636257.13   
18          4504.31         4507.04         13369070255795.90   
19          4493.86         4479.01         13222587445498.48   
20          4508.24         4505.12         13167670983446.76   
21          4497.42         4499.65         13301755233493.62   
22          4509.35         4529.78         13154909873498.27   
23          4491.46         4514.13         13390984870946.13   
24          4497.85         4531.45         13252664593162.88   

               sum(s_acctbal)  
c_nationkey                    
0           13135947461813.83  
1           13109570484166.52  
2           13276329410714.19  
3           13260121352641.59  
4           13168230420466.88  
5           13270548889539.71  
6           13255999087516.73  
7           13317813742584.13  
8           13231301968194.10  
9           13053014471235.28  
10          13544226414833.09  
11          13220904953852.09  
12          13202710511338.45  
13          13062683219957.92  
14          12939342250164.17  
15          13198360088664.20  
16          13009336466808.88  
17          13127980878530.39  
18          13377172818749.44  
19          13178897453144.76  
20          13158569941796.00  
21          13308361848968.49  
22          13214482559726.61  
23          13458574251406.53  
24          13351658802394.96  
2022-06-21 00:53:22,200 - main.py[line:407] - INFO: relative error:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           0.00            0.00            0.00            0.00           
1           0.03            0.03            0.03            0.03           
2           0.01            0.02            0.01            0.02           
3           0.02            0.00            0.02            0.00           
4           0.01            0.01            0.01            0.01           
5           0.01            0.01            0.01            0.01           
6           0.00            0.01            0.00            0.01           
7           0.01            0.00            0.01            0.00           
8           0.01            0.02            0.01            0.02           
9           0.00            0.02            0.00            0.02           
10          0.02            0.03            0.02            0.03           
11          0.00            0.02            0.00            0.02           
12          0.03            0.01            0.03            0.01           
13          0.01            0.02            0.01            0.02           
14          0.00            0.03            0.00            0.03           
15          0.00            0.01            0.00            0.01           
16          0.02            0.01            0.02            0.01           
17          0.00            0.00            0.00            0.00           
18          0.01            0.02            0.01            0.02           
19          0.04            0.00            0.04            0.00           
20          0.01            0.00            0.01            0.00           
21          0.01            0.01            0.01            0.01           
22          0.02            0.02            0.02            0.02           
23          0.00            0.01            0.00            0.01           
24          0.01            0.01            0.01            0.01           
2022-06-21 00:53:22,203 - main.py[line:408] - INFO: relative error normalized:
             avg(c_acctbal)  avg(s_acctbal)  sum(c_acctbal)  sum(s_acctbal)
c_nationkey                                                                
0           0.00            0.00            0.00            0.00           
1           0.03            0.03            0.03            0.03           
2           0.01            0.02            0.01            0.02           
3           0.02            0.00            0.02            0.00           
4           0.01            0.01            0.01            0.01           
5           0.01            0.01            0.01            0.01           
6           0.00            0.01            0.00            0.01           
7           0.01            0.00            0.01            0.00           
8           0.01            0.02            0.01            0.02           
9           0.00            0.02            0.00            0.02           
10          0.02            0.03            0.02            0.03           
11          0.00            0.02            0.00            0.02           
12          0.03            0.01            0.03            0.01           
13          0.01            0.02            0.01            0.02           
14          0.00            0.03            0.00            0.03           
15          0.00            0.01            0.00            0.01           
16          0.02            0.01            0.02            0.01           
17          0.00            0.00            0.00            0.00           
18          0.01            0.02            0.01            0.02           
19          0.04            0.00            0.04            0.00           
20          0.01            0.00            0.01            0.00           
21          0.01            0.01            0.01            0.01           
22          0.02            0.02            0.02            0.02           
23          0.00            0.01            0.00            0.01           
24          0.01            0.01            0.01            0.01           
2022-06-21 00:53:22,203 - main.py[line:411] - INFO: relative error average :0.012116061245375011
2022-06-21 00:53:22,203 - main.py[line:412] - INFO: relative error normalized average :0.012005156922522946
2022-06-21 00:53:22,204 - main.py[line:458] - INFO: total_time:14.875351674854755
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
   c_nationkey  c_acctbal  tpch-1m-customer_rate
0  0           4468.41    0.01                  
1  0           -324.02    0.01                  
2  0           7704.12    0.01                  
3  0           1634.76    0.01                  
4  0           4794.85    0.01                  
5  0           -305.49    0.01                  
6  0           7630.49    0.01                  
7  0           -343.87    0.01                  
8  0           1516.08    0.01                  
9  0           4769.74    0.01                  
   c_nationkey  c_acctbal  tpch-1m-customer_rate
0  0           1696.46    0.01                  
1  0           4685.99    0.01                  
2  0           4675.02    0.01                  
3  0           7524.99    0.01                  
4  0           9401.73    0.01                  
5  0           4757.12    0.01                  
6  0           4825.82    0.01                  
7  0           -305.22    0.01                  
8  0           9399.23    0.01                  
9  0           4760.27    0.01                  
   c_nationkey  c_acctbal  tpch-1m-customer_rate
0  0           9383.00    0.01                  
1  0           9393.83    0.01                  
2  0           1712.47    0.01                  
3  0           1759.05    0.01                  
4  0           1737.87    0.01                  
5  0           7494.77    0.01                  
6  0           7575.17    0.01                  
7  0           1624.14    0.01                  
8  0           4743.22    0.01                  
9  0           7602.63    0.01                  
categorical_columns: ['s_nationkey_0', 's_nationkey_1', 's_nationkey_2', 's_nationkey_3', 's_nationkey_4', 's_nationkey_5']
categorical_columns: ['s_nationkey_0', 's_nationkey_1', 's_nationkey_2', 's_nationkey_3', 's_nationkey_4', 's_nationkey_5']
   s_nationkey  s_acctbal  tpch-1m-supplier_rate
0  0           4231.13    0.10                  
1  0           4139.32    0.10                  
2  0           4260.40    0.10                  
3  0           7279.42    0.10                  
4  0           9140.84    0.10                  
5  0           4292.26    0.10                  
6  0           7380.71    0.10                  
7  0           1121.77    0.10                  
8  0           7178.54    0.10                  
9  0           -389.40    0.10                  
   s_nationkey  s_acctbal  tpch-1m-supplier_rate
0  0           7371.21    0.10                  
1  0           4351.48    0.10                  
2  0           1381.58    0.10                  
3  0           1272.51    0.10                  
4  0           9262.06    0.10                  
5  0           1223.08    0.10                  
6  0           4325.94    0.10                  
7  0           4233.25    0.10                  
8  0           7202.03    0.10                  
9  0           7348.33    0.10                  
categorical_columns: ['s_nationkey_0', 's_nationkey_1', 's_nationkey_2', 's_nationkey_3', 's_nationkey_4', 's_nationkey_5']
   s_nationkey  s_acctbal  tpch-1m-supplier_rate
0  0           4300.31    0.10                  
1  0           -382.87    0.10                  
2  0           4173.81    0.10                  
3  0           7261.06    0.10                  
4  0           4030.79    0.10                  
5  0           7164.42    0.10                  
6  0           1344.03    0.10                  
7  0           4063.04    0.10                  
8  0           7301.84    0.10                  
9  0           4377.49    0.10                  
